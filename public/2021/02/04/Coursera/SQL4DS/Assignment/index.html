<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/icons8-%E7%8C%AB-32-4.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/icons8-%E7%8C%AB-16-4.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=EB Garamond:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"ycchen00.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="IBM下Databases and SQL for Data Science的Assignments答案~"><meta property="og:type" content="article"><meta property="og:title" content="Coursera | Databases and SQL for Data Science (IBM) | Assignment"><meta property="og:url" content="https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/index.html"><meta property="og:site_name" content="猫咪的小鱼干"><meta property="og:description" content="IBM下Databases and SQL for Data Science的Assignments答案~"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_edX/images/LOADschool.jpg"><meta property="og:image" content="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_edX/images/URI.jpg"><meta property="article:published_time" content="2021-02-04T03:22:38.429Z"><meta property="article:modified_time" content="2021-02-04T09:05:40.976Z"><meta property="article:author" content="买猫咪的小鱼干"><meta property="article:tag" content="Coursera"><meta property="article:tag" content="DataScience"><meta property="article:tag" content="Python"><meta property="article:tag" content="SQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_edX/images/LOADschool.jpg"><link rel="canonical" href="https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><script>window.addEventListener('DOMContentLoaded', () => {
    'use strict';
    
      if (NexT.utils.hasMobileUA()) return;
    
    let time, hidden, visible, title = document.title;
    let favicon = document.querySelector('link[rel="icon"]');
    
      hidden = '╭(°A°`)╮猫咪出门啦~';
      visible = 'o(=•ェ•=)m猫咪又回来啦~';
    
    let random = t => t[Math.floor(Math.random() * t.length)];
    const change = () => {
      if (document.hidden) {
        favicon.setAttribute('href', '/images/icons8-猫屁股-16.png');
        
          document.title = hidden;
        
        clearTimeout(time);
      } else {
        favicon.setAttribute('href', '/images/icons8-猫-16-4.ico');
        
          document.title = visible;
        
        time = setTimeout(() => {
          document.title = title;
        }, 2020);
      }
    }
    document.addEventListener('visibilitychange', change, false);
  });</script><title>Coursera | Databases and SQL for Data Science (IBM) | Assignment | 猫咪的小鱼干</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="猫咪的小鱼干" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">猫咪的小鱼干</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-movies"><a href="/movies/" rel="section"><i class="fas fa-film fa-fw"></i>观影</a></li><li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="fas fa-book fa-fw"></i>阅读</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/ycchen00" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar_blackRainbow.jpg"><meta itemprop="name" content="买猫咪的小鱼干"><meta itemprop="description" content="overthinker"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="猫咪的小鱼干"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Coursera | Databases and SQL for Data Science (IBM) | Assignment<a href="https://github.com/ycchen00/ycchen00.github.io/tree/hexo/source/_posts/Coursera/SQL4DS/Assignment.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pencil-alt"></i></a></h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-02-04 11:22:38 / 修改时间：17:05:40" itemprop="dateCreated datePublished" datetime="2021-02-04T11:22:38+08:00">2021-02-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Coursera/" itemprop="url" rel="index"><span itemprop="name">Coursera</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Coursera/DataScience/" itemprop="url" rel="index"><span itemprop="name">DataScience</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Coursera/DataScience/SQL4DS/" itemprop="url" rel="index"><span itemprop="name">SQL4DS</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Disqus：</span> <a title="disqus" href="/2021/02/04/Coursera/SQL4DS/Assignment/#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/02/04/Coursera/SQL4DS/Assignment/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>8.7k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>其他链接：<br><a href="https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Quiz/">Coursera | Databases and SQL for Data Science(IBM) | Quiz</a><br><a href="https://ycchen00.github.io/2021/02/04/DSci/SQL/SQL+Python%20API%E7%9B%B8%E5%85%B3%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B(SQL4DS%E7%AC%94%E8%AE%B0)/">SQL | SQL+Python API相关入门教程(SQL4DS笔记)</a></p><p>这个assignment也也也也不难，除了一开始的数据导入可能有点小麻烦，其他和quiz差不多。</p><p><strong>!!!!!:<br>这里是导入我的数据库，用自己的数据库需要先根据教程自己导入相关tables，和相关credential等操作，不赘述，这里直接运行应该也没问题。但是记得改成自己的！后面SQL语言无需变动 :)</strong></p><h1 id="Course-Assignment"><a href="#Course-Assignment" class="headerlink" title="Course Assignment"></a>Course Assignment</h1><p>Using this Python notebook you will:</p><ol><li>Understand 3 Chicago datasets</li><li>Load the 3 datasets into 3 tables in a Db2 database</li><li>Execute SQL queries to answer assignment questions</li></ol><h2 id="Understand-the-datasets"><a href="#Understand-the-datasets" class="headerlink" title="Understand the datasets"></a>Understand the datasets</h2><p>To complete the assignment problems in this notebook you will be using three datasets that are available on the city of Chicago’s Data Portal:</p><ol><li><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Health-Human-Services/Census-Data-Selected-socioeconomic-indicators-in-C/kn9c-c2s2">Socioeconomic Indicators in Chicago</a></li><li><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Education/Chicago-Public-Schools-Progress-Report-Cards-2011-/9xs2-f89t">Chicago Public Schools</a></li><li><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2">Chicago Crime Data</a></li></ol><h3 id="Socioeconomic-Indicators-in-Chicago"><a href="#Socioeconomic-Indicators-in-Chicago" class="headerlink" title="Socioeconomic Indicators in Chicago"></a>Socioeconomic Indicators in Chicago</h3><p>This dataset contains a selection of six socioeconomic indicators of public health significance and a “hardship index,” for each Chicago community area, for the years 2008 – 2012.</p><p>For this assignment you will use a snapshot of this dataset which can be downloaded from:<a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_SKO/data/Census_Data_-_Selected_socioeconomic_indicators_in_Chicago__2008___2012-v2.csv" target="_blank"> Census Data</a></p><p>A detailed description of this dataset and the original dataset can be obtained from the Chicago Data Portal at:<br><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Health-Human-Services/Census-Data-Selected-socioeconomic-indicators-in-C/kn9c-c2s2?cm_mmc=Email_Newsletter-_-Developer_Ed+Tech-_-WW_WW-_-SkillsNetwork-Courses-IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork-20127838&cm_mmca1=000026UJ&cm_mmca2=10006555&cm_mmca3=M12345678&cvosrc=email.Newsletter.M12345678&cvo_campaign=000026UJ&cm_mmc=Email_Newsletter-_-Developer_Ed+Tech-_-WW_WW-_-SkillsNetwork-Courses-IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork-20127838&cm_mmca1=000026UJ&cm_mmca2=10006555&cm_mmca3=M12345678&cvosrc=email.Newsletter.M12345678&cvo_campaign=000026UJ">https://data.cityofchicago.org/Health-Human-Services/Census-Data-Selected-socioeconomic-indicators-in-C/kn9c-c2s2</a></p><h3 id="Chicago-Public-Schools"><a href="#Chicago-Public-Schools" class="headerlink" title="Chicago Public Schools"></a>Chicago Public Schools</h3><p>This dataset shows all school level performance data used to create CPS School Report Cards for the 2011-2012 school year. This dataset is provided by the city of Chicago’s Data Portal.</p><p>For this assignment you will use a snapshot of this dataset which can be downloaded from: <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_SKO/data/Chicago_Public_Schools_-_Progress_Report_Cards__2011-2012-v3.csv" target="_blank">Chicago Public School</a></p><p>A detailed description of this dataset and the original dataset can be obtained from the Chicago Data Portal at:<br><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Education/Chicago-Public-Schools-Progress-Report-Cards-2011-/9xs2-f89t?cm_mmc=Email_Newsletter-_-Developer_Ed+Tech-_-WW_WW-_-SkillsNetwork-Courses-IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork-20127838&cm_mmca1=000026UJ&cm_mmca2=10006555&cm_mmca3=M12345678&cvosrc=email.Newsletter.M12345678&cvo_campaign=000026UJ">https://data.cityofchicago.org/Education/Chicago-Public-Schools-Progress-Report-Cards-2011-/9xs2-f89t</a></p><h3 id="Chicago-Crime-Data"><a href="#Chicago-Crime-Data" class="headerlink" title="Chicago Crime Data"></a>Chicago Crime Data</h3><p>This dataset reflects reported incidents of crime (with the exception of murders where data exists for each victim) that occurred in the City of Chicago from 2001 to present, minus the most recent seven days.</p><p>This dataset is quite large - over 1.5GB in size with over 6.5 million rows. For the purposes of this assignment we will use a much smaller sample of this dataset which can be downloaded from:<a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_SKO/data/Chicago_Crime_Data-v2.csv" target="_blank"> Chicago Crime Data</a></p><p>A detailed description of this dataset and the original dataset can be obtained from the Chicago Data Portal at:<br><a target="_blank" rel="noopener" href="https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2?cm_mmc=Email_Newsletter-_-Developer_Ed+Tech-_-WW_WW-_-SkillsNetwork-Courses-IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork-20127838&cm_mmca1=000026UJ&cm_mmca2=10006555&cm_mmca3=M12345678&cvosrc=email.Newsletter.M12345678&cvo_campaign=000026UJ">https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2</a></p><h2 id="Download-the-datasets"><a href="#Download-the-datasets" class="headerlink" title="Download the datasets"></a>Download the datasets</h2><p>In many cases the dataset to be analyzed is available as a .CSV (comma separated values) file, perhaps on the internet. Click on the links below to download and save the datasets (.CSV files):</p><ol><li><p><strong>CENSUS_DATA:</strong> <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_Coursera/data/Census_Data_-_Selected_socioeconomic_indicators_in_Chicago__2008___2012-v2.csv" target="_blank">Census Dataset</a></p></li><li><p><strong>CHICAGO_PUBLIC_SCHOOLS</strong> <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_Coursera/data/Chicago_Public_Schools_-_Progress_Report_Cards__2011-2012-v3.csv" target="_blank">Chicago Public School</a></p></li><li><p><strong>CHICAGO_CRIME_DATA:</strong> <a href="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_Coursera/data/Chicago_Crime_Data-v2.csv" target="_blank">Chicago Crime Data</a></p></li></ol><p><strong>NOTE:</strong> Ensure you have downloaded the datasets using the links above instead of directly from the Chicago Data Portal. The versions linked here are subsets of the original datasets and have some of the column names modified to be more database friendly which will make it easier to complete this assignment.</p><h2 id="Store-the-datasets-in-database-tables"><a href="#Store-the-datasets-in-database-tables" class="headerlink" title="Store the datasets in database tables"></a>Store the datasets in database tables</h2><p>To analyze the data using SQL, it first needs to be stored in the database.</p><p>While it is easier to read the dataset into a Pandas dataframe and then PERSIST it into the database as we saw in Week 3 Lab 3, it results in mapping to default datatypes which may not be optimal for SQL querying. For example a long textual field may map to a CLOB instead of a VARCHAR.</p><p>Therefore, <strong>it is highly recommended to manually load the table using the database console LOAD tool, as indicated in Week 2 Lab 1 Part II</strong>. The only difference with that lab is that in Step 5 of the instructions you will need to click on create “(+) New Table” and specify the name of the table you want to create and then click “Next”.</p><img src="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_edX/images/LOADschool.jpg"><p><strong>Now open the Db2 console, open the LOAD tool, Select / Drag the .CSV file for the first dataset, Next create a New Table, and then follow the steps on-screen instructions to load the data. Name the new tables as folows:</strong></p><ol><li><strong>CENSUS_DATA</strong></li><li><strong>CHICAGO_PUBLIC_SCHOOLS</strong></li><li><strong>CHICAGO_CRIME_DATA</strong></li></ol><h2 id="Connect-to-the-database"><a href="#Connect-to-the-database" class="headerlink" title="Connect to the database"></a>Connect to the database</h2><p>Let us first load the SQL extension and establish a connection with the database</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%load_ext sql</span><br></pre></td></tr></table></figure><pre><code>The sql extension is already loaded. To reload it, use:
  %reload_ext sql</code></pre><p>In the next cell enter your db2 connection string. Recall you created Service Credentials for your Db2 instance in first lab in Week 3. From the <strong>uri</strong> field of your Db2 service credentials copy everything after db2:// (except the double quote at the end) and paste it in the cell below after ibm_db_sa://</p><img src="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_edX/images/URI.jpg"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Remember the connection string is of the format:</span></span><br><span class="line"><span class="comment"># %sql ibm_db_sa://my-username:my-password@my-hostname:my-port/my-db-name</span></span><br><span class="line"><span class="comment"># Enter the connection string for your Db2 on Cloud database instance below</span></span><br><span class="line">%sql ibm_db_sa://wls55462:<span class="number">2l</span>s9wcg2s5l7n%<span class="number">4008</span>@dashdb-txn-sbox-yp-dal09<span class="number">-04.</span>services.dal.bluemix.net:<span class="number">50000</span>/BLUDB</span><br></pre></td></tr></table></figure><pre><code>&#39;Connected: wls55462@BLUDB&#39;</code></pre><h2 id="Problems"><a href="#Problems" class="headerlink" title="Problems"></a>Problems</h2><p>Now write and execute SQL queries to solve assignment problems</p><h3 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem 1"></a>Problem 1</h3><p><strong>Find the total number of crimes recorded in the CRIME table</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql select COUNT(*) <span class="keyword">as</span> TOTAL_CRIMES <span class="keyword">from</span> CHICAGO_CRIME_DATA</span><br></pre></td></tr></table></figure><table><thead><tr><th>total_crimes</th></tr></thead><tbody><tr><td>533</td></tr></tbody></table><h3 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem 2"></a>Problem 2</h3><p><strong>Retrieve first 10 rows from the CRIME table</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT * FROM CHICAGO_CRIME_DATA LIMIT <span class="number">10</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>case_number</th><th>DATE</th><th>block</th><th>iucr</th><th>primary_type</th><th>description</th><th>location_description</th><th>arrest</th><th>domestic</th><th>beat</th><th>district</th><th>ward</th><th>community_area_number</th><th>fbicode</th><th>x_coordinate</th><th>y_coordinate</th><th>YEAR</th><th>updatedon</th><th>latitude</th><th>longitude</th><th>location</th></tr></thead><tbody><tr><td>3512276</td><td>HK587712</td><td>08/28/2004 05:50:56 PM</td><td>047XX S KEDZIE AVE</td><td>890</td><td>THEFT</td><td>FROM BUILDING</td><td>SMALL RETAIL STORE</td><td>FALSE</td><td>FALSE</td><td>911</td><td>9</td><td>14</td><td>58</td><td>6</td><td>1155838</td><td>1873050</td><td>2004</td><td>02/10/2018 03:50:01 PM</td><td>41.80744050</td><td>-87.70395585</td><td>(41.8074405, -87.703955849)</td></tr><tr><td>3406613</td><td>HK456306</td><td>06/26/2004 12:40:00 PM</td><td>009XX N CENTRAL PARK AVE</td><td>820</td><td>THEFT</td><td>$500 AND UNDER</td><td>OTHER</td><td>FALSE</td><td>FALSE</td><td>1112</td><td>11</td><td>27</td><td>23</td><td>6</td><td>1152206</td><td>1906127</td><td>2004</td><td>02/28/2018 03:56:25 PM</td><td>41.89827996</td><td>-87.71640551</td><td>(41.898279962, -87.716405505)</td></tr><tr><td>8002131</td><td>HT233595</td><td>04/04/2011 05:45:00 AM</td><td>043XX S WABASH AVE</td><td>820</td><td>THEFT</td><td>$500 AND UNDER</td><td>NURSING HOME/RETIREMENT HOME</td><td>FALSE</td><td>FALSE</td><td>221</td><td>2</td><td>3</td><td>38</td><td>6</td><td>1177436</td><td>1876313</td><td>2011</td><td>02/10/2018 03:50:01 PM</td><td>41.81593313</td><td>-87.62464213</td><td>(41.815933131, -87.624642127)</td></tr><tr><td>7903289</td><td>HT133522</td><td>12/30/2010 04:30:00 PM</td><td>083XX S KINGSTON AVE</td><td>840</td><td>THEFT</td><td>FINANCIAL ID THEFT: OVER $300</td><td>RESIDENCE</td><td>FALSE</td><td>FALSE</td><td>423</td><td>4</td><td>7</td><td>46</td><td>6</td><td>1194622</td><td>1850125</td><td>2010</td><td>02/10/2018 03:50:01 PM</td><td>41.74366532</td><td>-87.56246276</td><td>(41.743665322, -87.562462756)</td></tr><tr><td>10402076</td><td>HZ138551</td><td>02/02/2016 07:30:00 PM</td><td>033XX W 66TH ST</td><td>820</td><td>THEFT</td><td>$500 AND UNDER</td><td>ALLEY</td><td>FALSE</td><td>FALSE</td><td>831</td><td>8</td><td>15</td><td>66</td><td>6</td><td>1155240</td><td>1860661</td><td>2016</td><td>02/10/2018 03:50:01 PM</td><td>41.77345530</td><td>-87.70648047</td><td>(41.773455295, -87.706480471)</td></tr><tr><td>7732712</td><td>HS540106</td><td>09/29/2010 07:59:00 AM</td><td>006XX W CHICAGO AVE</td><td>810</td><td>THEFT</td><td>OVER $500</td><td>PARKING LOT/GARAGE(NON.RESID.)</td><td>FALSE</td><td>FALSE</td><td>1323</td><td>12</td><td>27</td><td>24</td><td>6</td><td>1171668</td><td>1905607</td><td>2010</td><td>02/10/2018 03:50:01 PM</td><td>41.89644677</td><td>-87.64493868</td><td>(41.896446772, -87.644938678)</td></tr><tr><td>10769475</td><td>HZ534771</td><td>11/30/2016 01:15:00 AM</td><td>050XX N KEDZIE AVE</td><td>810</td><td>THEFT</td><td>OVER $500</td><td>STREET</td><td>FALSE</td><td>FALSE</td><td>1713</td><td>17</td><td>33</td><td>14</td><td>6</td><td>1154133</td><td>1933314</td><td>2016</td><td>02/10/2018 03:50:01 PM</td><td>41.97284491</td><td>-87.70860008</td><td>(41.972844913, -87.708600079)</td></tr><tr><td>4494340</td><td>HL793243</td><td>12/16/2005 04:45:00 PM</td><td>005XX E PERSHING RD</td><td>860</td><td>THEFT</td><td>RETAIL THEFT</td><td>GROCERY FOOD STORE</td><td>TRUE</td><td>FALSE</td><td>213</td><td>2</td><td>3</td><td>38</td><td>6</td><td>1180448</td><td>1879234</td><td>2005</td><td>02/28/2018 03:56:25 PM</td><td>41.82387989</td><td>-87.61350386</td><td>(41.823879885, -87.613503857)</td></tr><tr><td>3778925</td><td>HL149610</td><td>01/28/2005 05:00:00 PM</td><td>100XX S WASHTENAW AVE</td><td>810</td><td>THEFT</td><td>OVER $500</td><td>STREET</td><td>FALSE</td><td>FALSE</td><td>2211</td><td>22</td><td>19</td><td>72</td><td>6</td><td>1160129</td><td>1838040</td><td>2005</td><td>02/28/2018 03:56:25 PM</td><td>41.71128051</td><td>-87.68917910</td><td>(41.711280513, -87.689179097)</td></tr><tr><td>3324217</td><td>HK361551</td><td>05/13/2004 02:15:00 PM</td><td>033XX W BELMONT AVE</td><td>820</td><td>THEFT</td><td>$500 AND UNDER</td><td>SMALL RETAIL STORE</td><td>FALSE</td><td>FALSE</td><td>1733</td><td>17</td><td>35</td><td>21</td><td>6</td><td>1153590</td><td>1921084</td><td>2004</td><td>02/28/2018 03:56:25 PM</td><td>41.93929582</td><td>-87.71092344</td><td>(41.939295821, -87.710923442)</td></tr></tbody></table><h3 id="Problem-3"><a href="#Problem-3" class="headerlink" title="Problem 3"></a>Problem 3</h3><p><strong>How many crimes involve an arrest?</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT COUNT(*) AS NUMBER_OF_ARRESTS \</span><br><span class="line">    FROM CHICAGO_CRIME_DATA \</span><br><span class="line">    WHERE ARREST = <span class="string">&quot;TRUE&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>number_of_arrests</th></tr></thead><tbody><tr><td>163</td></tr></tbody></table><h3 id="Problem-4"><a href="#Problem-4" class="headerlink" title="Problem 4"></a>Problem 4</h3><p><strong>Which unique types of crimes have been recorded at GAS STATION locations?</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT DISTINCT PRIMARY_TYPE \</span><br><span class="line">    FROM CHICAGO_CRIME_DATA \</span><br><span class="line">    WHERE LOCATION_DESCRIPTION = <span class="string">&#x27;GAS STATION&#x27;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>primary_type</th></tr></thead><tbody><tr><td>CRIMINAL TRESPASS</td></tr><tr><td>NARCOTICS</td></tr><tr><td>ROBBERY</td></tr><tr><td>THEFT</td></tr></tbody></table><p><strong>Hint: Which column lists types of crimes e.g. THEFT?</strong></p><h3 id="Problem-5"><a href="#Problem-5" class="headerlink" title="Problem 5"></a>Problem 5</h3><p><strong>In the CENUS_DATA table list all Community Areas whose names start with the letter ‘B’.</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT COMMUNITY_AREA_NAME \</span><br><span class="line">    FROM CENSUS_DATA \</span><br><span class="line">    WHERE COMMUNITY_AREA_NAME LIKE <span class="string">&#x27;B%&#x27;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>community_area_name</th></tr></thead><tbody><tr><td>Belmont Cragin</td></tr><tr><td>Burnside</td></tr><tr><td>Brighton Park</td></tr><tr><td>Bridgeport</td></tr><tr><td>Beverly</td></tr></tbody></table><h3 id="Problem-6"><a href="#Problem-6" class="headerlink" title="Problem 6"></a>Problem 6</h3><p><strong>Which schools in Community Areas 10 to 15 are healthy school certified?</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT NAME_OF_SCHOOL \</span><br><span class="line">FROM CHICAGO_PUBLIC_SCHOOLS \</span><br><span class="line">WHERE COMMUNITY_AREA_NUMBER BETWEEN <span class="number">10</span> AND <span class="number">15</span> \</span><br><span class="line">AND HEALTHY_SCHOOL_CERTIFIED = <span class="string">&#x27;Yes&#x27;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>name_of_school</th></tr></thead><tbody><tr><td>Rufus M Hitch Elementary School</td></tr></tbody></table><h3 id="Problem-7"><a href="#Problem-7" class="headerlink" title="Problem 7"></a>Problem 7</h3><p><strong>What is the average school Safety Score?</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT AVG(SAFETY_SCORE) AS AVERAGE \</span><br><span class="line">FROM CHICAGO_PUBLIC_SCHOOLS</span><br></pre></td></tr></table></figure><table><thead><tr><th>average</th></tr></thead><tbody><tr><td>49.504873</td></tr></tbody></table><h3 id="Problem-8"><a href="#Problem-8" class="headerlink" title="Problem 8"></a>Problem 8</h3><p><strong>List the top 5 Community Areas by average College Enrollment [number of students]</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT COMMUNITY_AREA_NAME, AVG(COLLEGE_ENROLLMENT) <span class="keyword">as</span> Number_of_Students\</span><br><span class="line">FROM CHICAGO_PUBLIC_SCHOOLS \</span><br><span class="line">GROUP BY COMMUNITY_AREA_NAME \</span><br><span class="line">ORDER BY Number_of_Students DESC LIMIT <span class="number">5</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>community_area_name</th><th>number_of_students</th></tr></thead><tbody><tr><td>ARCHER HEIGHTS</td><td>2411.500000</td></tr><tr><td>MONTCLARE</td><td>1317.000000</td></tr><tr><td>WEST ELSDON</td><td>1233.333333</td></tr><tr><td>BRIGHTON PARK</td><td>1205.875000</td></tr><tr><td>BELMONT CRAGIN</td><td>1198.833333</td></tr></tbody></table><h3 id="Problem-9"><a href="#Problem-9" class="headerlink" title="Problem 9"></a>Problem 9</h3><p><strong>Use a sub-query to determine which Community Area has the least value for school Safety Score?</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT COMMUNITY_AREA_NAME, SAFETY_SCORE \</span><br><span class="line">FROM CHICAGO_PUBLIC_SCHOOLS \</span><br><span class="line">WHERE SAFETY_SCORE = \</span><br><span class="line">(SELECT MIN(SAFETY_SCORE) FROM CHICAGO_PUBLIC_SCHOOLS)</span><br></pre></td></tr></table></figure><table><thead><tr><th>community_area_name</th><th>safety_score</th></tr></thead><tbody><tr><td>WASHINGTON PARK</td><td>1</td></tr></tbody></table><h3 id="Problem-10"><a href="#Problem-10" class="headerlink" title="Problem 10"></a>Problem 10</h3><p><strong>[Without using an explicit JOIN operator] Find the Per Capita Income of the Community Area which has a school Safety Score of 1.</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%sql SELECT CD.COMMUNITY_AREA_NAME, CD.PER_CAPITA_INCOME \</span><br><span class="line">FROM CENSUS_DATA CD, CHICAGO_PUBLIC_SCHOOLS CPS \</span><br><span class="line">WHERE CD.COMMUNITY_AREA_NUMBER = CPS.COMMUNITY_AREA_NUMBER \</span><br><span class="line">AND CPS.SAFETY_SCORE = <span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>community_area_name</th><th>per_capita_income</th></tr></thead><tbody><tr><td>Washington Park</td><td>13785</td></tr></tbody></table></div><div><div><div style="text-align:center;color:#555;font-size:20px">------------------ &emsp; The End &emsp;<i class="fas fa-cat"></i>&emsp; Thanks for reading &emsp; ------------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>买猫咪的小鱼干</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/" title="Coursera | Databases and SQL for Data Science (IBM) | Assignment">https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Coursera/" rel="tag"><i class="fas fa-fish"></i> Coursera</a> <a href="/tags/DataScience/" rel="tag"><i class="fas fa-fish"></i> DataScience</a> <a href="/tags/Python/" rel="tag"><i class="fas fa-fish"></i> Python</a> <a href="/tags/SQL/" rel="tag"><i class="fas fa-fish"></i> SQL</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2021/02/04/Coursera/SQL4DS/Quiz/" rel="prev" title="Coursera | Databases and SQL for Data Science (IBM) | Quiz"><i class="fa fa-chevron-left"></i> Coursera | Databases and SQL for Data Science (IBM) | Quiz</a></div><div class="post-nav-item"><a href="/2021/02/04/DSci/SQL/SQL+Python%20API%E7%9B%B8%E5%85%B3%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B(SQL4DS%E7%AC%94%E8%AE%B0)/" rel="next" title="SQL | SQL+Python API相关入门教程">SQL | SQL+Python API相关入门教程 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><div><canvas id="canvas" style="width:60%">当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>!function(){var o,a,r,f,t,i=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],e=document.getElementById("canvas");function h(t,e){for(var n=[1,2,3],l=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],o=0;o<i[e].length;o++)for(var a,h=0;h<i[e][o].length;h++)1==i[e][o][h]&&(a={x:14*(f+2)*t+2*h*(f+1)+(f+1),y:2*o*(f+1)+(f+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*n[Math.floor(Math.random()*n.length)],color:l[Math.floor(Math.random()*l.length)],disY:1},r.push(a))}function n(){e.height=100;for(var t=0;t<a.length;t++)!function(t,e){for(var n=0;n<i[e].length;n++)for(var l=0;l<i[e][n].length;l++)1==i[e][n][l]&&(o.beginPath(),o.arc(14*(f+2)*t+2*l*(f+1)+(f+1),2*n*(f+1)+(f+1),f,0,2*Math.PI),o.closePath(),o.fill())}(t,a[t]);for(t=0;t<r.length;t++)o.beginPath(),o.arc(r[t].x,r[t].y,f,0,2*Math.PI),o.fillStyle=r[t].color,o.closePath(),o.fill()}e.getContext&&(o=e.getContext("2d"),e.height=100,e.width=700,o.fillStyle="#f00",o.fillRect(10,10,50,50),a=[],r=[],f=e.height/20-1,t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),a.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6]),clearInterval(void 0),setInterval(function(){!function(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),n=[];n.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var l=a.length-1;0<=l;l--)n[l]!==a[l]&&t.push(l+"_"+(Number(a[l])+1)%10);for(l=0;l<t.length;l++)h.apply(this,t[l].split("_"));a=n.concat()}(),function(){for(var t=0;t<r.length;t++)r[t].stepY+=r[t].disY,r[t].x+=r[t].stepX,r[t].y+=r[t].stepY,(r[t].x>700+f||r[t].y>100+f)&&(r.splice(t,1),t--)}(),n()},50))}()</script><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Course-Assignment"><span class="nav-text">Course Assignment</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Understand-the-datasets"><span class="nav-text">Understand the datasets</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Socioeconomic-Indicators-in-Chicago"><span class="nav-text">Socioeconomic Indicators in Chicago</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Chicago-Public-Schools"><span class="nav-text">Chicago Public Schools</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Chicago-Crime-Data"><span class="nav-text">Chicago Crime Data</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Download-the-datasets"><span class="nav-text">Download the datasets</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Store-the-datasets-in-database-tables"><span class="nav-text">Store the datasets in database tables</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Connect-to-the-database"><span class="nav-text">Connect to the database</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Problems"><span class="nav-text">Problems</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-1"><span class="nav-text">Problem 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-2"><span class="nav-text">Problem 2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-3"><span class="nav-text">Problem 3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-4"><span class="nav-text">Problem 4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-5"><span class="nav-text">Problem 5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-6"><span class="nav-text">Problem 6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-7"><span class="nav-text">Problem 7</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-8"><span class="nav-text">Problem 8</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-9"><span class="nav-text">Problem 9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-10"><span class="nav-text">Problem 10</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="买猫咪的小鱼干" src="/images/avatar_blackRainbow.jpg"><p class="site-author-name" itemprop="name">买猫咪的小鱼干</p><div class="site-description" itemprop="description">overthinker</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">69</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">29</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">44</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/ycchen00" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ycchen00" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:cyc348674274@gmail.com" title="E-Mail → mailto:cyc348674274@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/weixin_43360896" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_43360896" rel="noopener" target="_blank"><i class="fas fa-crosshairs fa-fw"></i>CSDN</a> </span><span class="links-of-author-item"><a href="https://twitter.com/cyc86908399" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;cyc86908399" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/2021/02/04/Tip/PayPal%E4%BB%98%E6%AC%BE/" title="PayPal大陆付款问题" target="_blank">PayPal大陆付款问题</a></li><li><a href="/2021/02/04/Debug/%E2%80%98image_dim_ordering%E2%80%98/" title="Debug | AttributeError： module ‘keras.backend‘ has no attribute ‘image_dim_ordering" target="_blank">Debug | AttributeError： module ‘keras.backend‘ has no attribute ‘image_dim_ordering</a></li><li><a href="/2021/02/04/Coursera/P2Web-Quiz/" title="Coursera | Using Python to Access Web Data (University of Michigan) | Quiz" target="_blank">Coursera | Using Python to Access Web Data (University of Michigan) | Quiz</a></li><li><a href="/2021/02/04/Python/pip%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%20&%20%E6%9B%B4%E6%8D%A2%E9%95%9C%E5%83%8F/" title="Python | pip设置代理 & 更换镜像" target="_blank">Python | pip设置代理 & 更换镜像</a></li><li><a href="/2021/02/04/Tip/cmder%E5%AE%89%E8%A3%85%E4%B8%8E%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/" title="Tip | cmder安装与常用配置" target="_blank">Tip | cmder安装与常用配置</a></li></ul></div><script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script><div class="widget-wrap"><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas" style="width:100%"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Business/" rel="tag">Business</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Colab/" rel="tag">Colab</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coursera/" rel="tag">Coursera</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-analytics/" rel="tag">Data analytics</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataFrame/" rel="tag">DataFrame</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataScience/" rel="tag">DataScience</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Debug/" rel="tag">Debug</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Excel/" rel="tag">Excel</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Folium/" rel="tag">Folium</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/" rel="tag">GPU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google/" rel="tag">Google</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Earth-Engine/" rel="tag">Google Earth Engine</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jupyter-Notebook/" rel="tag">Jupyter Notebook</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-learning/" rel="tag">Machine learning</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Matplotlib/" rel="tag">Matplotlib</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OneNote/" rel="tag">OneNote</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pandas/" rel="tag">Pandas</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PayPal/" rel="tag">PayPal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Photography/" rel="tag">Photography</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Remote-sensing/" rel="tag">Remote sensing</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Seaborn/" rel="tag">Seaborn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Visualization/" rel="tag">Visualization</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Waffle-Charts/" rel="tag">Waffle Charts</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/" rel="tag">cmd</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmder/" rel="tag">cmder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crawler/" rel="tag">crawler</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iPhone/" rel="tag">iPhone</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/" rel="tag">json</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/" rel="tag">pip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shortcuts/" rel="tag">shortcuts</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordcloud/" rel="tag">wordcloud</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" rel="tag">个人博客</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BD%B1%E8%AF%84/" rel="tag">影评</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%B5%E5%BD%B1/" rel="tag">电影</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/" rel="tag">离散数学</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E9%85%92/" rel="tag">调酒</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag">随笔</a><span class="tag-list-count">1</span></li></ul></canvas></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fas fa-fish"></i> </span><span class="author" itemprop="copyrightHolder">买猫咪的小鱼干</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">355k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">5:22</span></div><script color="0,0,0" opacity="0.5" zindex="-1" count="150" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("10/18/2020 20:20:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>(function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":null,"app_key":null,"server_url":null,"security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();</script></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script defer src="/lib/three/three.min.js"></script><script>!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script>function loadCount(){var d=document,n=d.createElement("script");n.src="https://ycchen00.disqus.com/count.js",n.id="dsq-count-scr",(d.head||d.body).appendChild(n)}window.addEventListener("load",loadCount,!1)</script><script>var disqus_config = function() {
    this.page.url = "https://ycchen00.github.io/2021/02/04/Coursera/SQL4DS/Assignment/";
    this.page.identifier = "2021/02/04/Coursera/SQL4DS/Assignment/";
    this.page.title = "Coursera | Databases and SQL for Data Science (IBM) | Assignment";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://ycchen00.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });</script><script type="text/javascript" src="/js/coreSocialistValues.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!1},log:!1})</script></body></html>